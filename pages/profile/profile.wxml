<!-- pages/profile/profile.wxml -->
<view class="container">
  <!-- 未登录状态 -->
  <view wx:if="{{!isLoggedIn}}" class="login-prompt">
    <view class="login-card">
      <text class="login-title">欢迎使用冥想助手</text>
      <text class="login-subtitle">登录后可以同步您的冥想数据</text>
      <button class="button button-primary button-large" bindtap="handleLogin">
        微信登录
      </button>
    </view>
  </view>

  <!-- 登录状态 -->
  <view wx:else>
    <!-- 加载状态 -->
    <view wx:if="{{loading}}" class="loading-container">
      <text class="loading-text">加载中...</text>
    </view>

    <!-- 错误状态 -->
    <view wx:if="{{error}}" class="error-container">
      <text class="error-text">{{error}}</text>
      <button class="button button-primary button-small" bindtap="retry">重试</button>
    </view>

    <!-- 正常内容 -->
    <view wx:if="{{!loading && !error}}" class="profile-content">
      <scroll-view scroll-y="true" class="scroll-container" enhanced="{{true}}" show-scrollbar="{{false}}">
        
        <!-- 用户信息卡片 -->
        <view class="user-card">
          <view class="user-icon">
            <image class="user-avatar" src="{{userInfo.avatar || '/assets/tabbar/profile.png'}}" />
          </view>
          <view class="user-info">
            <text class="user-name">{{userInfo.username || '冥想用户'}}</text>
            <text class="user-email">{{userInfo.email || '完善您的个人信息'}}</text>
            <text class="edit-link" bindtap="editProfile">编辑资料</text>
          </view>
        </view>


        <!-- 更多功能 -->
        <view class="more-functions-section">
          <text class="more-functions-title">更多功能</text>
          
          <view class="function-card" bindtap="shareApp">
            <view class="function-left">
              <image src="/assets/share.svg" class="function-icon" />
              <view class="function-info">
                <text class="function-title">分享应用</text>
                <text class="function-subtitle">邀请好友一起冥想</text>
              </view>
            </view>
            <icon type="right" size="16" color="#78909C" class="function-arrow" />
          </view>
          
          <view class="function-card" bindtap="viewFeedback">
            <view class="function-left">
              <image src="/assets/feedback.svg" class="function-icon" />
              <view class="function-info">
                <text class="function-title">意见反馈</text>
                <text class="function-subtitle">帮助我们改进产品</text>
              </view>
            </view>
            <icon type="right" size="16" color="#78909C" class="function-arrow" />
          </view>
          
          <view class="function-card" bindtap="viewAbout">
            <view class="function-left">
              <image src="/assets/about.svg" class="function-icon" />
              <view class="function-info">
                <text class="function-title">关于我们</text>
                <text class="function-subtitle">了解应用信息</text>
              </view>
            </view>
            <icon type="right" size="16" color="#78909C" class="function-arrow" />
          </view>
        </view>

        <!-- 应用信息 -->
        <view class="app-info">
          <text class="app-version">版本 1.0.0</text>
          <text class="app-copyright">© 2024 冥想助手</text>
        </view>

      </scroll-view>
    </view>
  </view>
</view>